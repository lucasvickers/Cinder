language: cpp
git:
  depth: 1

fast_finish: false


# OS X has no version unique dependencies, so we are able to use matrix
os: osx

compiler:
  - clang
  - gcc

matrix:
  include:

    # linux version have unique dependencies, so we set them up individually
    - os: linux
      dist: trusty
      compiler: clang
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-4.9
      sudo: required
      env: TARGET="trusty"

# TODO figure out docker support
#- os: linux
#    dist: trusty
#    sudo: required
#    env: TARGET="yakkety"
#    services: docker

    - os: osx
      osx_image: xcode8.2
    - os: osx
      osx_image: xcode8.1
    - os: osx
      osx_image: xcode8
    - os: osx
      osx_image: xcode7.3
    - os: osx
      osx_image: xcode7.2
    - os: osx
      osx_image: xcode7.1
    - os: osx
      osx_image: xcode7
    - os: osx
      osx_image: xcode6.4

install:
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then
      tools/ci/"$TARGET"-install-deps.sh;
    fi

script:
  - tools/ci/cmake_test.sh;
    